try Date.From(Text.Range([#"Source.Name"], Text.Length([#"Source.Name"]) - 15, 10)) otherwise null   para procesadas

try Date.FromText(
    Text.Middle(Text.BeforeDelimiter([#"Source.Name"], ".xlsx"), Text.Length(Text.BeforeDelimiter([#"Source.Name"], ".xlsx")) - 8, 2) & "-" &
    Text.Middle(Text.BeforeDelimiter([#"Source.Name"], ".xlsx"), Text.Length(Text.BeforeDelimiter([#"Source.Name"], ".xlsx")) - 5, 2) & "-" &
    "20" & Text.End(Text.BeforeDelimiter([#"Source.Name"], ".xlsx"), 2)
) otherwise null
  para sometidas


try Date.FromText(
    Text.Middle(Text.BeforeDelimiter([#"Source.Name"], ".xlsx"), Text.Length(Text.BeforeDelimiter([#"Source.Name"], ".xlsx")) - 8, 2) & "-" &
    Text.Middle(Text.BeforeDelimiter([#"Source.Name"], ".xlsx"), Text.Length(Text.BeforeDelimiter([#"Source.Name"], ".xlsx")) - 6, 2) & "-" &
    Text.End(Text.BeforeDelimiter([#"Source.Name"], ".xlsx"), 4)
) otherwise null
          para no procesadas


Para quitar los casos que no se toman en cuenta dentro del analisis:

Table.SelectRows(#"Paso anterior", each [Referencia] <> 0)



PARA CRUCE


Primer en lbtr no procesada

Crear columna Referencia_Recortada (primeros 9 d√≠gitos del TRANSACTION_ID):

Text.Start(Text.From([TRANSACTION_ID]), 9)

Cambiar nombre de columnas para que se alineen con las transacciones:

Table.RenameColumns(#"Paso anterior", {
  {"CUENTA", "Numero de cuenta"},
  {"Referencia_Recortada", "Referencia"},
  {"MONTO", "Valor"}
})

join key column

[Numero de cuenta] & "-" & Text.From([Referencia]) & "-" & Text.From([Valor])




